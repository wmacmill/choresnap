!function(window,document,$,undefined){"use strict";var app={appp:"undefined"!=typeof window.appp?window.appp:!1,woo:"undefined"!=typeof window.apppwoo?window.apppwoo:!1,snapper:new Snap({element:document.getElementById("page"),disable:"right",hyperextensible:!1,touchToDrag:!1}),spinner:null,scriptsLoaded:{},stylesLoaded:{},xhr:[],scriptsLoadedCount:0,stylesLoadedCount:0,backhref:"",backLoad:!1,history:[],laststate:window.location.href,timeout:!1,isWidth600:!0,$:{},modalID:""};app.cacheSelectors=function(){app.$.body=$("body"),app.$.main=$("#main"),app.$.ajaxModal=$("#ajaxModal"),app.$.modalInside=$(".modal-inside"),app.$.ioModal=$(".io-modal")},app.init=function(){app.cacheSelectors();var a;if(app.appp){app.logGroup("apppresser.init()"),app.log("window.appp",app.appp),app.log("window.apppwoo",app.woo),setTimeout(function(){app.scriptLoader(),app.styleLoader(),app.setCurrentNav()},1e3),window.history.replaceState({},"",window.location.href),app.history.unshift({url:window.location.href}),localStorage.urlHistory||(localStorage.urlHistory=JSON.stringify(app.history)),app.$.body.append('<div class="ajax-spinner"><div class="spinner"></div></div>'),app.$.spinner=$(".ajax-spinner"),$(".site-header").on("touchmove",function(a){a.preventDefault()}),$(".site-footer").on("touchmove",function(a){a.preventDefault()});var e=new Hammer($(".site-title-wrap").get(0));e.on("doubletap",function(a){app.$.main.animate({scrollTop:0},"fast")}),$("body").on("click","#main a",function(a){var e=new RegExp("/"+window.location.host+"/");e.test(a.target.href)||$(this).is('[href*="#"]')||"A"!=a.target.tagName||(a.preventDefault(),a.stopPropagation(),window.open(a.target.href,"_blank"))}),window.matchMedia&&(a=window.matchMedia("(min-width: 600px)"),a.addListener(function(a){app.isWidth600=a.matches,app.log("Width "+(app.isWidth600?">":"<")+" 600")})),app.logGroup(!0),app.isWidth600=a&&a.matches,app.$.subMenu=$(".snap-drawer li").has("ul.sub-menu, ul.children").children("a").addClass("has-sub-menu"),app.$.subMenu.next("ul").prepend('<a href="#" class="menu-back"><i class="fa fa-angle-left fa-lg"></i> '+l10n.back+"</a>"),app.$.subMenu.append('<i class="fa fa-angle-right fa-lg pull-right"></i>'),app.backhref=app.woo&&app.woo.is_shop?app.woo.shop_url:app.appp.home_url,app.$.body.on("click",".ajaxify, .ajaxify a, .blog .post a, li.previous a, li.next a, .entry-meta a, .entry-title a, .page-links a, .comment-author a, .woocommerce-pagination a, .products li a:first-child",function(a){var e=$(this);app.canAjax(e)&&app.loadAjaxContent(e.attr("href"),!1,a)}).on("click",".snap-drawer li a",function(a){var e=$(this),t=e.hasClass("has-sub-menu"),p=e.parent().hasClass("external");t&&$(a.target).next("ul").addClass("open-sub-menu"),p&&window.open($(this).attr("href"),"_blank"),app.canAjax(e)&&(app.loadAjaxContent(e.attr("href"),!1,a),app.isWidth600||"left"!=app.snapper.state().state||t||app.snapper.close())}).on("click",".footer-menu a",function(a){var e=$(this);app.canAjax(e)&&(app.loadAjaxContent(e.attr("href"),!1,a),app.isWidth600||"left"!=app.snapper.state().state||app.snapper.close())}).on("click","a.back",function(a){a.preventDefault(),app.backLoad=!0;var e=JSON.parse(localStorage.urlHistory);e.length<=1||(e.shift(),setTimeout(function(){app.loadAjaxContent(e[0].url,!1,a)},0),localStorage.urlHistory=JSON.stringify(e))}).on("click",".menu-back",function(a){a.preventDefault(),$(this).closest("ul").removeClass("open-sub-menu")}).on("click","a.modal-toggle, .modal-toggle a",function(a){if(apppresser.canModal($(this))){a.preventDefault();var e=this.href+" #content";app.$.ajaxModal.modal(),app.$.modalInside.load(e)}}).on("click","#nav-left-open",function(){"left"==app.snapper.state().state?app.snapper.close():app.snapper.open("left")}).on("click",".io-modal-open, .io-modal-close",function(a){a.preventDefault();var e="slide-in-up-add ng-animate slide-in-up slide-in-up-add-active",t="slide-in-up-remove slide-in-up-remove-active";$(this).hasClass("io-modal-open")?(app.modalID=$(this).attr("href"),"#loginModal"==app.modalID&&$("input[name=redirect_to]").val(window.location),$(app.modalID).css("display","block").removeClass(t).addClass(e),setTimeout(function(){$("textarea#whats-new").focus()},1e3)):($(".io-modal").removeClass(e).addClass(t).css("display","none"),$("form").trigger("reset"))}),app.snapper.on("open",function(){app.$.ioModal.data("isOpen")&&app.ioModal.close()}),FastClick.attach(document.body),document.addEventListener("offline",function(){alert(l10n.offline)},!1)}},app.ioModal=function(){var a="slide-in-up-add ng-animate slide-in-up slide-in-up-add-active",e="slide-in-up-remove slide-in-up-remove-active";return{open:function(){app.$.ioModal.removeClass(e).addClass(a).data("isOpen",!0).trigger("isOpen")},close:function(){app.$.ioModal.removeClass(a).addClass(e).data("isOpen",!1).trigger("isClosed"),setTimeout(function(){app.$.ioModal.removeClass(e)},150)}}}(),app.setCurrentNav=function(){var a=$('.has-sub-menu[href="'+window.location.href+'"]');if(a.length){a.next("ul").addClass("open-sub-menu");for(var e=a.parents(".sub-menu");e.length;)e.addClass("open-sub-menu"),e=e.parents(".sub-menu")}},app.scriptLoader=function(a){a=a||$("script[src]");var e={},t,p,o=0,n="length"in app.scriptsLoaded;return app.scriptsLoaded.length=n?app.scriptsLoaded.length:0,a.each(function(){var a=$(this);return a.data("loaded")===!0?!0:(p=a.attr("src"),t=p.replace(/^.*[\\\/]/,"").replace(/(\?.*)|(#.*)/g,""),t in app.scriptsLoaded?!0:(app.scriptsLoaded.length++,o++,app.scriptsLoaded[t]=p,e[t]=p,void a.data("loaded",!0)))}),app.log("scriptLoader"),o?(n&&app.log("addedscripts",o,e),app.log("app.scriptsLoaded",app.scriptsLoaded),app.log("END scriptLoader"),e):(app.log("No new scripts to load."),e)},app.styleLoader=function(a){a=a||$('link[type="text/css"]');var e={},t,p,o=0,n="length"in app.stylesLoaded;return app.stylesLoaded.length=n?app.stylesLoaded.length:0,a.each(function(){var a=$(this);return a.data("loaded")===!0?!0:(p=a.attr("href"),t=p.replace(/^.*[\\\/]/,"").replace(/(\?.*)|(#.*)/g,""),t in app.stylesLoaded?!0:(app.stylesLoaded.length++,o++,app.stylesLoaded[t]=p,e[t]=p,void a.data("loaded",!0)))}),app.log("styleLoader"),o?(n&&app.log("addedStyles",o,e),app.log("app.stylesLoaded",app.stylesLoaded),app.log("END styleLoader"),e):(app.log("No new styles to load."),e)},app.loadAjaxContent=function(a,e,t){var p=t.target,o=a.split("/");if(("#"!==o[o.length-1].charAt(0)||$(p).parent().hasClass("back"))&&(t&&t.preventDefault(),app.untrailingslashit(a)!==app.untrailingslashit(window.location.href))){var n={title:$("title"),navtitle:$(".site-title-wrap h1")};if(e=e||app.$.main,a=a||this.href,app.timeout&&clearTimeout(app.timeout),$.each(app.xhr,function(a,e){e.abort()}),app.doingAjax!==!0){app.doingAjax=!0,app.$.spinner.show(),setTimeout(function(){},6e4);var i=$.ajax({url:a,type:"GET",dataType:"html",cache:!1}).done(function(t){var p=$("<div>").append($.parseHTML(t,document,!0)),o=p.find("#main"),i={title:p.find("title"),navtitle:p.find(".site-title-wrap h1")},s=o.attr("class").replace("site-main",""),r=o.children().unwrap(),l=p.find("#top-menu3"),d=p.find(".pull-left"),c=p.find(".io-modal"),u=p.find("#activity-post-form"),f=app.scriptLoader(p.find("script[src]")),h=app.styleLoader(p.find('link[type="text/css"]'));app.$.body.attr("class",s),app.$.main.attr("class",s),n.title.text(i.title.text()),n.navtitle.html(i.navtitle.html()),$("#top-menu3").replaceWith(l),$(".pull-left").replaceWith(d),$("#activity-post-form").replaceWith(u),e.html(r),app.change_url(a),app.timeout=setTimeout(function(){$.each(f,function(a,e){app.log("$.each(scripts)",a,e);var t=app.loadScript(e,!0,function(){app.scriptsLoadedCount++,app.log("script retrieved",e),app.log("scripts retrieved",app.scriptsLoadedCount)});t&&(t.done(function(a,e,t){}).fail(function(a,t,p){app.log("loadScript: Triggered ajaxError handler for: "+e,p)}),app.xhr.push(t))}),$.each(h,function(a,e){app.log("$.each(styles)",a,e),app.loadCSS(e),app.stylesLoadedCount++,app.log("style retrieved",e),app.log("styles retrieved",app.stylesLoadedCount)})},30),$(document).trigger("load_ajax_content_done",$,e,a),app.$.body.trigger("post-load",$,e,a)}).complete(function(a,e){if(app.$.spinner.fadeOut("fast"),"success"===e){if(app.$.main.animate({scrollTop:0},"fast"),$(p).parents().hasClass("footer-menu")){var t=$(p).attr("href");$(".footer-menu li").removeClass("current_page_item"),$(p).parent().addClass("current_page_item"),$("#site-navigation ul.menu li").removeClass("current_page_item"),$('#site-navigation ul.menu a[href="'+t+'"]').parent().addClass("current_page_item")}if($(p).parents().hasClass("menu")){var t=$(p).attr("href");$("#site-navigation ul.menu li").removeClass("current_page_item"),$(p).parent().addClass("current_page_item"),$(".footer-menu li").removeClass("current_page_item"),$('.footer-menu a[href="'+t+'"]').parent().addClass("current_page_item")}}});app.xhr.push(i),app.doingAjax=!1}}},app.canAjax=function(a){return apppresser.appp.can_ajax&&!a.is(".menu-back, .external, .no-ajax, .menu .no-ajax > a, .nav-divider, .modal-toggle, .modal-toggle a")||a.is(".back")},app.canModal=function(a){return apppresser.appp.can_ajax&&!a.is("a.no-modal, .no-modal a")},app.change_url=function(a){a=a||apppresser.backhref,window.history.pushState({},"",a);var e=JSON.parse(localStorage.urlHistory);app.backLoad||e.unshift({url:a}),localStorage.urlHistory=JSON.stringify(e),app.backLoad=!1},app.loadL10n=function(html){var inlineScripts=html.find("script[type='text/javascript']").text(),pattern=/\/\* <!\[CDATA\[ \*\/([\s\S]*)\/\* \]\]> \*\//,matches=inlineScripts.match(pattern),script=matches[1];eval(script)},app.loadScript=function(a,e,t){var p=!1,o=null;return $.isFunction(e)?(o=e,p=t||p):(p=e||p,o=t||o),$.ajax({url:a,type:"GET",dataType:"script",cache:p,success:o})},app.loadCSS=function(a){var e=$("<link>");$("head").append(e),e.attr({rel:"stylesheet",type:"text/css",href:a})},app.untrailingslashit=function(a){return"/"==a.substr(-1)?a.substr(0,a.length-1):a},app.log=function(){this.appp.debug&&console&&"function"==typeof console.log&&console.log.apply(console,arguments)},app.logGroup=function(a,e){this.appp.debug&&console&&"function"==typeof console.group&&(a===!0?console.groupEnd():"undefined"==typeof a?e?console.group():console.groupCollapsed():e?console.group(a):console.groupCollapsed(a))},app.init(),window.apppresser=app}(window,document,jQuery);