
(function(window,document,$,undefined){'use strict';var app={appp:typeof window.appp!=='undefined'?window.appp:false,woo:typeof window.apppwoo!=='undefined'?window.apppwoo:false,snapper:new Snap({element:document.getElementById('page'),disable:'right',hyperextensible:false,touchToDrag:false}),spinner:null,scriptsLoaded:{},stylesLoaded:{},xhr:[],scriptsLoadedCount:0,stylesLoadedCount:0,backhref:'',backLoad:false,history:[],laststate:window.location.href,timeout:false,isWidth600:true,$:{},modalID:''};app.cacheSelectors=function(){app.$.body=$('body');app.$.main=$('#main');app.$.ajaxModal=$('#ajaxModal');app.$.modalInside=$('.modal-inside');app.$.ioModal=$('.io-modal');}
app.init=function(){app.cacheSelectors();var isWidth600Check;if(!app.appp)
return;app.logGroup('apppresser.init()');app.log('window.appp',app.appp);app.log('window.apppwoo',app.woo);setTimeout(function(){app.scriptLoader();app.styleLoader();app.setCurrentNav();},1000);window.history.replaceState({},'',window.location.href);app.history.unshift({url:window.location.href});if(!localStorage['urlHistory'])
localStorage['urlHistory']=JSON.stringify(app.history);app.$.body.append('<div class="ajax-spinner"><div class="spinner"></div></div>');app.$.spinner=$('.ajax-spinner');$('.site-header').on('touchmove',function(e){e.preventDefault();});$('.site-footer').on('touchmove',function(e){e.preventDefault();});var hammertime=new Hammer($('.site-title-wrap').get(0));hammertime.on('doubletap',function(ev){app.$.main.animate({scrollTop:0},'fast');});$('body').on('click','#main a',function(e){var a=new RegExp('/'+window.location.host+'/');if(!a.test(e.target.href)){if(!$(this).is('[href*="#"]')&&e.target.tagName=='A'){e.preventDefault();e.stopPropagation();window.open(e.target.href,'_blank');}}});if(window.matchMedia){isWidth600Check=window.matchMedia('(min-width: 600px)');isWidth600Check.addListener(function(mediaQueryList){app.isWidth600=mediaQueryList.matches;app.log('Width '+(app.isWidth600?'>':'<')+' 600');});}
app.logGroup(true);app.isWidth600=isWidth600Check&&isWidth600Check.matches;app.$.subMenu=$('.snap-drawer li').has('ul.sub-menu, ul.children').children('a').addClass('has-sub-menu');app.$.subMenu.next('ul').prepend('<a href="#" class="menu-back"><i class="fa fa-angle-left fa-lg"></i> '+l10n.back+'</a>');app.$.subMenu.append('<i class="fa fa-angle-right fa-lg pull-right"></i>');app.backhref=app.woo&&app.woo.is_shop?app.woo.shop_url:app.appp.home_url;app.$.body.on('click','.ajaxify, .ajaxify a, .blog .post a, li.previous a, li.next a, .entry-meta a, .entry-title a, .page-links a, .comment-author a, .woocommerce-pagination a',function(event){var $self=$(this);if(app.canAjax($self))
app.loadAjaxContent($self.attr('href'),false,event);}).on('click','.snap-drawer li a',function(event){var $self=$(this);var hasSubMenu=$self.hasClass('has-sub-menu');var hasExternal=$self.parent().hasClass('external');if(hasSubMenu){$(event.target).next('ul').addClass('open-sub-menu');}
if(hasExternal){window.open($(this).attr('href'),'_blank');}
if(app.canAjax($self)){app.loadAjaxContent($self.attr('href'),false,event);if(!app.isWidth600&&app.snapper.state().state=='left'&&!hasSubMenu)
app.snapper.close();}}).on('click','.footer-menu a',function(event){var $self=$(this);if(app.canAjax($self)){app.loadAjaxContent($self.attr('href'),false,event);if(!app.isWidth600&&app.snapper.state().state=='left')
app.snapper.close();}}).on('click','a.back',function(event){event.preventDefault();app.backLoad=true;var prevUrl=JSON.parse(localStorage['urlHistory']);if(prevUrl.length<=1)return;prevUrl.shift();setTimeout(function(){app.loadAjaxContent(prevUrl[0]['url'],false,event);},0);localStorage['urlHistory']=JSON.stringify(prevUrl);}).on('click','.menu-back',function(event){event.preventDefault();$(this).closest('ul').removeClass('open-sub-menu');}).on('click','a.modal-toggle, .modal-toggle a',function(event){if(!apppresser.canModal($(this)))
return;event.preventDefault();var content=this.href+' #content';app.$.ajaxModal.modal();app.$.modalInside.load(content);}).on('click','#nav-left-open',function(){if(app.snapper.state().state=='left')
app.snapper.close();else
app.snapper.open('left');}).on('click','.io-modal-open, .io-modal-close',function(event){event.preventDefault();var UpClasses='slide-in-up-add ng-animate slide-in-up slide-in-up-add-active';var downClasses='slide-in-up-remove slide-in-up-remove-active';if($(this).hasClass('io-modal-open')){app.modalID=$(this).attr('href');if(app.modalID=='#loginModal'){$('input[name=redirect_to]').val(window.location);}
$(app.modalID).css('display','block').removeClass(downClasses).addClass(UpClasses);setTimeout(function(){$('textarea#whats-new').focus();},1000);}else{$('.io-modal').removeClass(UpClasses).addClass(downClasses).css('display','none');$('form').trigger("reset");}});app.snapper.on('open',function(){if(app.$.ioModal.data('isOpen')){app.ioModal.close();}});FastClick.attach(document.body);document.addEventListener("offline",function(){alert(l10n.offline);},false);}
app.ioModal=(function(){var UpClasses='slide-in-up-add ng-animate slide-in-up slide-in-up-add-active';var downClasses='slide-in-up-remove slide-in-up-remove-active';return{open:function(){app.$.ioModal.removeClass(downClasses).addClass(UpClasses).data('isOpen',true).trigger('isOpen');},close:function(){app.$.ioModal.removeClass(UpClasses).addClass(downClasses).data('isOpen',false).trigger('isClosed');setTimeout(function(){app.$.ioModal.removeClass(downClasses);},150);}}})();app.setCurrentNav=function(){var $current=$('.has-sub-menu[href="'+window.location.href+'"]');if($current.length){$current.next('ul').addClass('open-sub-menu');var $parent=$current.parents('.sub-menu');while($parent.length){$parent.addClass('open-sub-menu');$parent=$parent.parents('.sub-menu');}}}
app.scriptLoader=function($scripts){'use strict';$scripts=$scripts||$('script[src]');var addedscripts={},filename,src,count=0,counted=('length'in app.scriptsLoaded);app.scriptsLoaded['length']=counted?app.scriptsLoaded['length']:0;$scripts.each(function(){var $self=$(this);if($self.data('loaded')===true)
return true;src=$self.attr('src');filename=src.replace(/^.*[\\\/]/,'').replace(/(\?.*)|(#.*)/g,'');if(filename in app.scriptsLoaded)
return true;app.scriptsLoaded['length']++;count++;app.scriptsLoaded[filename]=src;addedscripts[filename]=src;$self.data('loaded',true);});app.log('scriptLoader');if(!count){app.log('No new scripts to load.');return addedscripts;}
if(counted)
app.log('addedscripts',count,addedscripts);app.log('app.scriptsLoaded',app.scriptsLoaded);app.log('END scriptLoader');return addedscripts;}
app.styleLoader=function($styles){'use strict';$styles=$styles||$('link[type="text/css"]');var addedStyles={},filename,src,count=0,counted=('length'in app.stylesLoaded);app.stylesLoaded['length']=counted?app.stylesLoaded['length']:0;$styles.each(function(){var $self=$(this);if($self.data('loaded')===true)
return true;src=$self.attr('href');filename=src.replace(/^.*[\\\/]/,'').replace(/(\?.*)|(#.*)/g,'');if(filename in app.stylesLoaded)
return true;app.stylesLoaded['length']++;count++;app.stylesLoaded[filename]=src;addedStyles[filename]=src;$self.data('loaded',true);});app.log('styleLoader');if(!count){app.log('No new styles to load.');return addedStyles;}
if(counted)
app.log('addedStyles',count,addedStyles);app.log('app.stylesLoaded',app.stylesLoaded);app.log('END styleLoader');return addedStyles;}
app.loadAjaxContent=function(href,$selector,event){'use strict';var that=event.target;var fragments=href.split('/');if(fragments[fragments.length-1].charAt(0)==='#'&&!$(that).parent().hasClass('back'))
return;if(event)
event.preventDefault();if(app.untrailingslashit(href)===app.untrailingslashit(window.location.href))
return;var titles={'title':$('title'),'navtitle':$('.site-title-wrap h1')};$selector=$selector||app.$.main;href=href||this.href;if(app.timeout)
clearTimeout(app.timeout);$.each(app.xhr,function(index,request){request.abort();});if(app.doingAjax===true)
return;app.doingAjax=true;app.$.spinner.show();setTimeout(function(){},60000);var status=$.ajax({url:href,type:'GET',dataType:'html',cache:false}).done(function(responseText){var html=$("<div>").append($.parseHTML(responseText,document,true));var $main=html.find('#main');var newtitles={'title':html.find('title'),'navtitle':html.find('.site-title-wrap h1')};var newclasses=$main.attr('class').replace('site-main','');var content=$main.children().unwrap();var appp_header_right=html.find('#top-menu3');var appp_pull_left=html.find('.pull-left');var appp_modal=html.find('.io-modal');var appp_activity_modal=html.find('#activity-post-form');var scripts=app.scriptLoader(html.find('script[src]'));var styles=app.styleLoader(html.find('link[type="text/css"]'));app.$.body.attr('class',newclasses);app.$.main.attr('class',newclasses);titles.title.text(newtitles.title.text());titles.navtitle.html(newtitles.navtitle.html());$('#top-menu3').replaceWith(appp_header_right);$('.pull-left').replaceWith(appp_pull_left);$('#activity-post-form').replaceWith(appp_activity_modal);$selector.html(content);app.change_url(href);app.timeout=setTimeout(function(){$.each(scripts,function(filename,url){app.log('$.each(scripts)',filename,url);var response=app.loadScript(url,true,function(){app.scriptsLoadedCount++;app.log('script retrieved',url);app.log('scripts retrieved',app.scriptsLoadedCount);});if(response){response.done(function(script,textStatus,jqXHR){}).fail(function(jqXHR,settings,exception){app.log('loadScript: Triggered ajaxError handler for: '+url,exception);});app.xhr.push(response);}});$.each(styles,function(filename,url){app.log('$.each(styles)',filename,url);app.loadCSS(url);app.stylesLoadedCount++;app.log('style retrieved',url);app.log('styles retrieved',app.stylesLoadedCount);});},30);$(document).trigger('load_ajax_content_done',$,$selector,href);app.$.body.trigger('post-load',$,$selector,href);}).complete(function(jqXHR,status){app.$.spinner.fadeOut('fast');if(status!=='success')
return;app.$.main.animate({scrollTop:0},'fast');if($(that).parents().hasClass('footer-menu')){var href=$(that).attr('href');$('.footer-menu li').removeClass('current_page_item');$(that).parent().addClass('current_page_item');$('#site-navigation ul.menu li').removeClass('current_page_item');$('#site-navigation ul.menu a[href="'+href+'"]').parent().addClass('current_page_item');}
if($(that).parents().hasClass('menu')){var href=$(that).attr('href');$('#site-navigation ul.menu li').removeClass('current_page_item');$(that).parent().addClass('current_page_item');$('.footer-menu li').removeClass('current_page_item');$('.footer-menu a[href="'+href+'"]').parent().addClass('current_page_item');}});app.xhr.push(status);app.doingAjax=false;}
app.canAjax=function($element){return(apppresser.appp.can_ajax&&!$element.is('.menu-back, .external, .no-ajax, .menu .no-ajax > a, .nav-divider, .modal-toggle, .modal-toggle a')||$element.is('.back'));}
app.canModal=function($element){return(apppresser.appp.can_ajax&&!$element.is('a.no-modal, .no-modal a'));}
app.change_url=function(newurl){'use strict';newurl=newurl||apppresser.backhref;window.history.pushState({},'',newurl);var prevUrl=JSON.parse(localStorage['urlHistory']);if(!app.backLoad){prevUrl.unshift({url:newurl});}
localStorage['urlHistory']=JSON.stringify(prevUrl);app.backLoad=false;}
app.loadL10n=function(html){var inlineScripts=html.find("script[type='text/javascript']").text();var pattern=/\/\* <!\[CDATA\[ \*\/([\s\S]*)\/\* \]\]> \*\//;var matches=inlineScripts.match(pattern);var script=matches[1];eval(script);}
app.loadScript=function(url,arg1,arg2){'use strict';var cache=false,callback=null;if($.isFunction(arg1)){callback=arg1;cache=arg2||cache;}else{cache=arg1||cache;callback=arg2||callback;}
return $.ajax({url:url,type:'GET',dataType:'script',cache:cache,success:callback});}
app.loadCSS=function(href){var cssLink=$('<link>');$("head").append(cssLink);cssLink.attr({rel:"stylesheet",type:"text/css",href:href});}
app.untrailingslashit=function(str){if(str.substr(-1)=='/'){return str.substr(0,str.length-1);}
return str;}
app.log=function(){'use strict';if(this.appp.debug&&console&&typeof console.log==='function'){console.log.apply(console,arguments);}}
app.logGroup=function(groupName,expanded){'use strict';if(this.appp.debug&&console&&typeof console.group==='function'){if(groupName===true){console.groupEnd();}else if(typeof groupName==='undefined'){if(expanded)
console.group();else
console.groupCollapsed();}else{if(expanded)
console.group(groupName);else
console.groupCollapsed(groupName);}}}
$('body').on('click','#respond #submit',function(){var $comment=$(this).closest('#respond').find('#comment'),comment=$.trim($comment.val());if(comment===''){alert(appp.i18n_required_comment_text);return false;}
var $rating=$(this).closest('#respond').find('#rating'),rating=$rating.val();if($rating.size()>0&&!rating&&wc_single_product_params.review_rating_required==='yes'&&!comment===''){alert(wc_single_product_params.i18n_required_rating_text);return false;}});app.init();window.apppresser=app;})(window,document,jQuery);